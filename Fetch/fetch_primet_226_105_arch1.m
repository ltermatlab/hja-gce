function [data,msg] = fetch_primet_226_105_arch1(template)

%connect to the database
conn = database('metdat', '', '', 'Vendor', 'MICROSOFT SQL SERVER', 'Server', 'Stewartia', 'PortNumber', 1433, 'AuthType', 'Windows');

if exist('template','var') ~= 1
   template = 'LNDB_PriMet_226_105_arch1';
end

%% Original 226 array based logger
%completed processing on 11-11-2013. Will require manual checks via GCE
%use process
% qry = ['SELECT PRI_226_105_arch1.TmStamp'...
%     ' ,	PRI_226_105_arch1.RecNum'...
%     ' ,	PRI_226_105_arch1.LOGGERID'...
%     ' ,	PRI_226_105_arch1.PROGID'...
%     ' ,	PRI_226_105_arch1.SNOW_PILL'... %mm
%     ' ,	PRI_226_105_arch1.SNOWDEPTH'... %m
%     ' ,	PRI_226_105_arch1.TB_PRECIP_TOT'... %tip
%     ' FROM 	metdat.dbo.PRI_226_105_arch1'...
%     ' WHERE year(TmStamp) = 2012'...
%     ' ORDER BY TmStamp ASC '];

% qry = ['SELECT PRI_226_105_arch2.TmStamp'...
%     ' ,	PRI_226_105_arch2.RecNum'...
%     ' ,	PRI_226_105_arch2.LOGGERID'...
%     ' ,	PRI_226_105_arch2.PROGID'...
%     ' ,	PRI_226_105_arch2.BATTERY_V_AVG'...
%     ' ,	PRI_226_105_arch2.SNOW_PILL'...
%     ' ,	PRI_226_105_arch2.SNOWDEPTH'...
%     ' ,	PRI_226_105_arch2.TB_PRECIP_TOT'...
%     ' FROM 	metdat.dbo.PRI_226_105_arch2'...
%     ' WHERE year(TmStamp) = 2012'...
%     ' ORDER BY TmStamp ASC '];

% qry = ['SELECT PRI_226_105_arch3.TmStamp'...
%     ' ,	PRI_226_105_arch3.RecNum'...
%     ' ,	PRI_226_105_arch3.LOGGERID'...
%     ' ,	PRI_226_105_arch3.PROGID'...
%     ' ,	PRI_226_105_arch3.BATTERY_V_AVG'...
%     ' ,	PRI_226_105_arch3.SNOW_PILL'...
%     ' ,	PRI_226_105_arch3.SNOWDEPTH'...
%     ' ,	PRI_226_105_arch3.TB_PRECIP_TOT'...
%     ' FROM 	metdat.dbo.PRI_226_105_arch3'...
%     ' WHERE year(TmStamp)= 2012'...
%     ' ORDER BY TmStamp ASC '];

qry = ['SELECT PRI_226_105_arch3.TmStamp'...
    ' ,	PRI_226_105_arch3.RecNum'...
    ' ,	PRI_226_105_arch3.LOGGERID'...
    ' ,	PRI_226_105_arch3.PROGID'...
    ' ,	PRI_226_105_arch3.BATTERY_V_AVG'...
    ' ,	PRI_226_105_arch3.SNOW_PILL'...
    ' ,	PRI_226_105_arch3.SNOWDEPTH'...
    ' ,	PRI_226_105_arch3.TB_PRECIP_TOT'...
    ' FROM 	metdat.dbo.PRI_226_105_arch3'...
    ' WHERE year(TmStamp) = 2013'...
    ' ORDER BY TmStamp ASC '];

% Last run with this fetch file. For new configuration, use
% process_primet_226_a_105.m



%% Beginning of new logger configuration for 226
% qry = ['SELECT TOP 200 PRIM_226_table105.TmStamp'...
%     ' ,	PRIM_226_table105.RecNum'...
%     ' ,	PRIM_226_table105.LOGGERID'...
%     ' ,	PRIM_226_table105.PROGID'...
%     ' ,	PRIM_226_table105.BATTERY_AVG'...
%     ' ,	PRIM_226_table105.QUALITY'...
%     ' ,	PRIM_226_table105.SNOWDEPTH'...
%     ' ,	PRIM_226_table105.WIND_DIR_DU_WVT'...
%     ' ,	PRIM_226_table105.WIND_DIR_SDU_WVT'...
%     ' ,	PRIM_226_table105.WINDSPEED_S_WVT'...
%     ' ,	PRIM_226_table105.WINDSPEED_U_WVT'...
%     ' FROM 	metdat.dbo.PRIM_226_table105'...
%     ' WHERE year(TmStamp) = 2013'...
%     ' ORDER BY TmStamp ASC'];

% qry = ['SELECT PRIM_226_table105.TmStamp'...
%     ' ,	PRIM_226_table105.RecNum'...
%     ' ,	PRIM_226_table105.LOGGERID'...
%     ' ,	PRIM_226_table105.PROGID'...
%     ' ,	PRIM_226_table105.BATTERY_AVG'...
%     ' ,	PRIM_226_table105.QUALITY'...
%     ' ,	PRIM_226_table105.SNOWDEPTH'...
%     ' ,	PRIM_226_table105.WIND_DIR_DU_WVT'...
%     ' ,	PRIM_226_table105.WIND_DIR_SDU_WVT'...
%     ' ,	PRIM_226_table105.WINDSPEED_S_WVT'...
%     ' ,	PRIM_226_table105.WINDSPEED_U_WVT'...
%     ' FROM 	metdat.dbo.PRIM_226_table105'...
%     ' WHERE   TmStamp >= DATEADD(day, -21, GETDATE())'...
%     ' ORDER BY TmStamp ASC '];

[data,msg] = sql2gceds(conn, ...
                        qry, ...
                        template, ...
                        1, ...
                        0, ...
                        1);

% %close database connection
 close(conn);



